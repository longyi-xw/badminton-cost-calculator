<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>提肛训练计时器 - 可自定义缩紧放松时间</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2980 0%, #26d0ce 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            width: 100%;
            max-width: 600px;
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #FFD700, #FFEC8B);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            line-height: 1.5;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .timer-container {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .time-display {
            font-size: 5rem;
            font-weight: 700;
            margin: 15px 0;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            letter-spacing: 2px;
            font-variant-numeric: tabular-nums;
        }
        
        .action-animation {
            width: 140px;
            height: 140px;
            margin: 0 auto 25px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            border: 3px solid rgba(255, 255, 255, 0.2);
        }
        
        .action-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            animation: action-pulse 4s infinite ease-in-out;
        }
        
        .tighten-animation {
            animation: tighten 4s infinite ease-in-out;
        }
        
        .relax-animation {
            animation: relax 4s infinite ease-in-out;
        }
        
        @keyframes tighten {
            0%, 100% { transform: scale(0.8); opacity: 0.7; background-color: rgba(255, 107, 107, 0.3); }
            50% { transform: scale(1.2); opacity: 1; background-color: rgba(255, 107, 107, 0.8); }
        }
        
        @keyframes relax {
            0%, 100% { transform: scale(1.2); opacity: 1; background-color: rgba(107, 255, 107, 0.8); }
            50% { transform: scale(0.8); opacity: 0.7; background-color: rgba(107, 255, 107, 0.3); }
        }
        
        .action-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.8rem;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 16px 28px;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 130px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn-start {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
        }
        
        .btn-pause {
            background: linear-gradient(135deg, #FF9800, #EF6C00);
            color: white;
        }
        
        .btn-reset {
            background: linear-gradient(135deg, #f44336, #C62828);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .settings-panel {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
        }
        
        .settings-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #FFD700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .setting-group {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
        }
        
        .setting-label {
            display: block;
            margin-bottom: 10px;
            font-size: 1rem;
            color: #FFEC8B;
        }
        
        .time-inputs {
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: space-between;
        }
        
        .time-input {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }
        
        .time-input span {
            font-size: 0.9rem;
            margin-bottom: 5px;
            opacity: 0.8;
        }
        
        .time-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #FFD700;
            margin: 5px 0;
            min-width: 60px;
            text-align: center;
        }
        
        .slider-container {
            width: 100%;
            margin-top: 10px;
        }
        
        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
            -webkit-appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: #FFD700;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        }
        
        .session-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .session-btn {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .session-btn.active {
            background: rgba(255, 215, 0, 0.3);
            border-color: #FFD700;
        }
        
        .session-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .stats {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin-top: 10px;
        }
        
        .stats h3 {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #FFD700;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .stat-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
            color: #FFD700;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .instructions {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
        }
        
        .instructions h3 {
            margin-bottom: 15px;
            color: #FFD700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .instructions ol {
            padding-left: 20px;
            line-height: 1.6;
        }
        
        .instructions li {
            margin-bottom: 10px;
        }
        
        footer {
            margin-top: 30px;
            text-align: center;
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        .phase-indicator {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }
        
        .phase-indicator .phase {
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .phase-tighten {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid rgba(255, 107, 107, 0.5);
        }
        
        .phase-tighten.active {
            background: rgba(255, 107, 107, 0.5);
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }
        
        .phase-relax {
            background: rgba(107, 255, 107, 0.2);
            border: 1px solid rgba(107, 255, 107, 0.5);
        }
        
        .phase-relax.active {
            background: rgba(107, 255, 107, 0.5);
            box-shadow: 0 0 10px rgba(107, 255, 107, 0.5);
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .time-display {
                font-size: 4rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
            
            .session-controls {
                flex-direction: column;
                align-items: center;
            }
            
            .session-btn {
                width: 100%;
                max-width: 300px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .action-animation {
                width: 120px;
                height: 120px;
            }
            
            .action-circle {
                width: 85px;
                height: 85px;
            }
            
            .action-text {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-clock"></i> 提肛训练计时器</h1>
            <p class="subtitle">自定义缩紧/放松时间，科学训练盆底肌，改善血液循环，预防疾病。</p>
        </header>
        
        <div class="main-content">
            <div class="timer-container">
                <div class="action-animation">
                    <div class="action-circle" id="action-circle"></div>
                    <div class="action-text" id="action-text">准备</div>
                </div>
                
                <div class="time-display" id="time-display">00:00</div>
                
                <div class="phase-indicator">
                    <div class="phase phase-tighten" id="tighten-indicator">缩紧</div>
                    <div class="phase phase-relax" id="relax-indicator">放松</div>
                </div>
                
                <div class="session-controls">
                    <div class="session-btn active" data-time="60">1分钟</div>
                    <div class="session-btn" data-time="180">3分钟</div>
                    <div class="session-btn" data-time="300">5分钟</div>
                    <div class="session-btn" data-time="600">10分钟</div>
                </div>
                
                <div class="controls">
                    <button class="btn btn-start" id="start-btn">
                        <i class="fas fa-play"></i> 开始训练
                    </button>
                    <button class="btn btn-pause" id="pause-btn" disabled>
                        <i class="fas fa-pause"></i> 暂停
                    </button>
                    <button class="btn btn-reset" id="reset-btn" disabled>
                        <i class="fas fa-redo"></i> 重置
                    </button>
                </div>
            </div>
            
            <div class="settings-panel">
                <h3 class="settings-title"><i class="fas fa-cog"></i> 训练参数设置</h3>
                <div class="settings-grid">
                    <div class="setting-group">
                        <label class="setting-label">缩紧/放松时间配置</label>
                        <div class="time-inputs">
                            <div class="time-input">
                                <span>缩紧时间</span>
                                <div class="time-value" id="tighten-value">3</div>
                                <span>秒</span>
                            </div>
                            <div class="time-input">
                                <span>放松时间</span>
                                <div class="time-value" id="relax-value">2</div>
                                <span>秒</span>
                            </div>
                        </div>
                        <div class="slider-container">
                            <input type="range" min="1" max="10" value="3" class="slider" id="tighten-slider">
                        </div>
                        <div class="slider-container">
                            <input type="range" min="1" max="10" value="2" class="slider" id="relax-slider">
                        </div>
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">训练提示设置</label>
                        <div style="margin-top: 15px;">
                            <label style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <input type="checkbox" id="sound-toggle" checked>
                                <span>提示音</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" id="vibration-toggle" checked>
                                <span>震动提示</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="stats">
                <h3><i class="fas fa-chart-line"></i> 训练统计</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="today-sessions">0</div>
                        <div class="stat-label">今日训练次数</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="total-time">0</div>
                        <div class="stat-label">累计时间(分钟)</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="current-streak">0</div>
                        <div class="stat-label">连续训练天数</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="total-sessions">0</div>
                        <div class="stat-label">总训练次数</div>
                    </div>
                </div>
            </div>
            
            <div class="instructions">
                <h3><i class="fas fa-info-circle"></i> 使用说明</h3>
                <ol>
                    <li>使用滑块设置缩紧和放松的时间（建议：缩紧3-5秒，放松2-3秒）</li>
                    <li>选择训练总时长（默认1分钟）</li>
                    <li>点击"开始训练"按钮，根据动画提示进行缩紧和放松</li>
                    <li>红色动画和"缩紧"文字提示时收缩盆底肌，保持设定时间</li>
                    <li>绿色动画和"放松"文字提示时完全放松盆底肌</li>
                    <li>训练结束后会有提示，统计会自动更新</li>
                    <li>建议每天训练2-3次，每次1-5分钟</li>
                </ol>
            </div>
        </div>
    </div>
    
    <footer>
        <p>提肛训练计时器 © 2023 | 科学训练，健康生活</p>
    </footer>

    <audio id="beep-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-alarm-digital-clock-beep-989.mp3" type="audio/mpeg">
    </audio>
    
    <script>
        // 获取DOM元素
        const timeDisplay = document.getElementById('time-display');
        const startBtn = document.getElementById('start-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const resetBtn = document.getElementById('reset-btn');
        const actionText = document.getElementById('action-text');
        const actionCircle = document.getElementById('action-circle');
        const sessionButtons = document.querySelectorAll('.session-btn');
        const beepSound = document.getElementById('beep-sound');
        
        // 设置相关元素
        const tightenSlider = document.getElementById('tighten-slider');
        const relaxSlider = document.getElementById('relax-slider');
        const tightenValue = document.getElementById('tighten-value');
        const relaxValue = document.getElementById('relax-value');
        const soundToggle = document.getElementById('sound-toggle');
        const vibrationToggle = document.getElementById('vibration-toggle');
        
        // 阶段指示器
        const tightenIndicator = document.getElementById('tighten-indicator');
        const relaxIndicator = document.getElementById('relax-indicator');
        
        // 统计元素
        const todaySessionsEl = document.getElementById('today-sessions');
        const totalTimeEl = document.getElementById('total-time');
        const currentStreakEl = document.getElementById('current-streak');
        const totalSessionsEl = document.getElementById('total-sessions');
        
        // 计时器变量
        let timer = null;
        let timeLeft = 60; // 默认60秒
        let initialTime = 60;
        let isRunning = false;
        let isPaused = false;
        
        // 缩紧/放松阶段变量
        let tightenTime = 3; // 缩紧时间（秒）
        let relaxTime = 2;   // 放松时间（秒）
        let currentPhase = 'tighten'; // 当前阶段：'tighten' 或 'relax'
        let phaseTimeLeft = tightenTime; // 当前阶段剩余时间
        
        // 统计变量
        let stats = {
            todaySessions: 0,
            totalTime: 0, // 分钟
            currentStreak: 0,
            totalSessions: 0,
            lastTrainingDate: null
        };
        
        // 从本地存储加载统计数据
        function loadStats() {
            const savedStats = localStorage.getItem('kegelTimerStats');
            if (savedStats) {
                stats = JSON.parse(savedStats);
                
                // 检查是否是新的一天
                const today = new Date().toDateString();
                if (stats.lastTrainingDate !== today) {
                    // 如果昨天训练了，连续天数增加，否则重置为0
                    const yesterday = new Date();
                    yesterday.setDate(yesterday.getDate() - 1);
                    if (stats.lastTrainingDate === yesterday.toDateString()) {
                        stats.currentStreak++;
                    } else {
                        stats.currentStreak = 0;
                    }
                    stats.todaySessions = 0;
                }
                
                updateStatsDisplay();
            }
            
            // 加载设置
            const savedSettings = localStorage.getItem('kegelTimerSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                tightenTime = settings.tightenTime || 3;
                relaxTime = settings.relaxTime || 2;
                tightenSlider.value = tightenTime;
                relaxSlider.value = relaxTime;
                tightenValue.textContent = tightenTime;
                relaxValue.textContent = relaxTime;
                soundToggle.checked = settings.soundEnabled !== false;
                vibrationToggle.checked = settings.vibrationEnabled !== false;
            }
        }
        
        // 保存统计数据到本地存储
        function saveStats() {
            stats.lastTrainingDate = new Date().toDateString();
            localStorage.setItem('kegelTimerStats', JSON.stringify(stats));
            updateStatsDisplay();
        }
        
        // 保存设置到本地存储
        function saveSettings() {
            const settings = {
                tightenTime,
                relaxTime,
                soundEnabled: soundToggle.checked,
                vibrationEnabled: vibrationToggle.checked
            };
            localStorage.setItem('kegelTimerSettings', JSON.stringify(settings));
        }
        
        // 更新统计显示
        function updateStatsDisplay() {
            todaySessionsEl.textContent = stats.todaySessions;
            totalTimeEl.textContent = Math.round(stats.totalTime);
            currentStreakEl.textContent = stats.currentStreak;
            totalSessionsEl.textContent = stats.totalSessions;
        }
        
        // 初始化统计
        loadStats();
        
        // 更新显示的时间
        function updateDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timeDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // 更新阶段显示
        function updatePhaseDisplay() {
            // 更新动作文字和动画
            if (currentPhase === 'tighten') {
                actionText.textContent = '缩紧';
                actionCircle.className = 'action-circle tighten-animation';
                tightenIndicator.classList.add('active');
                relaxIndicator.classList.remove('active');
            } else {
                actionText.textContent = '放松';
                actionCircle.className = 'action-circle relax-animation';
                relaxIndicator.classList.add('active');
                tightenIndicator.classList.remove('active');
            }
            
            // 添加阶段剩余时间提示
            actionText.innerHTML = `${actionText.textContent}<br><small>${phaseTimeLeft}s</small>`;
        }
        
        // 开始计时器
        function startTimer() {
            if (isRunning) return;
            
            isRunning = true;
            isPaused = false;
            startBtn.disabled = true;
            pauseBtn.disabled = false;
            resetBtn.disabled = false;
            
            // 初始化阶段
            currentPhase = 'tighten';
            phaseTimeLeft = tightenTime;
            updatePhaseDisplay();
            
            // 更新按钮文本
            startBtn.innerHTML = '<i class="fas fa-play"></i> 训练中...';
            startBtn.classList.add('pulse');
            
            timer = setInterval(() => {
                timeLeft--;
                phaseTimeLeft--;
                
                updateDisplay();
                updatePhaseDisplay();
                
                // 阶段时间结束，切换到下一个阶段
                if (phaseTimeLeft <= 0) {
                    // 切换阶段
                    if (currentPhase === 'tighten') {
                        currentPhase = 'relax';
                        phaseTimeLeft = relaxTime;
                    } else {
                        currentPhase = 'tighten';
                        phaseTimeLeft = tightenTime;
                    }
                    
                    // 播放提示音和震动
                    if (soundToggle.checked) {
                        beepSound.currentTime = 0;
                        beepSound.play();
                    }
                    
                    if (vibrationToggle.checked && 'vibrate' in navigator) {
                        navigator.vibrate(100);
                    }
                    
                    updatePhaseDisplay();
                }
                
                // 总时间到
                if (timeLeft <= 0) {
                    finishTimer();
                }
            }, 1000);
        }
        
        // 暂停计时器
        function pauseTimer() {
            if (!isRunning) return;
            
            clearInterval(timer);
            isRunning = false;
            isPaused = true;
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            
            // 更新按钮文本
            startBtn.innerHTML = '<i class="fas fa-play"></i> 继续训练';
            startBtn.classList.remove('pulse');
        }
        
        // 重置计时器
        function resetTimer() {
            clearInterval(timer);
            isRunning = false;
            isPaused = false;
            timeLeft = initialTime;
            currentPhase = 'tighten';
            phaseTimeLeft = tightenTime;
            
            updateDisplay();
            updatePhaseDisplay();
            
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            resetBtn.disabled = true;
            
            // 更新按钮文本
            startBtn.innerHTML = '<i class="fas fa-play"></i> 开始训练';
            startBtn.classList.remove('pulse');
        }
        
        // 完成计时
        function finishTimer() {
            clearInterval(timer);
            isRunning = false;
            
            // 播放完成提示音
            if (soundToggle.checked) {
                beepSound.currentTime = 0;
                beepSound.play();
            }
            
            if (vibrationToggle.checked && 'vibrate' in navigator) {
                navigator.vibrate([100, 100, 100]);
            }
            
            // 更新统计数据
            stats.todaySessions++;
            stats.totalSessions++;
            stats.totalTime += initialTime / 60; // 转换为分钟
            
            // 保存统计数据
            saveStats();
            
            // 显示完成消息
            timeDisplay.innerHTML = `<span style="color:#FFD700; font-size:3.5rem;">完成!</span>`;
            actionText.innerHTML = '完成!<br><small>训练结束</small>';
            actionCircle.style.animation = 'none';
            
            // 重置按钮状态
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            resetBtn.disabled = false;
            
            // 更新按钮文本
            startBtn.innerHTML = '<i class="fas fa-redo"></i> 重新开始';
            startBtn.classList.remove('pulse');
            
            // 3秒后重置显示
            setTimeout(() => {
                timeLeft = initialTime;
                currentPhase = 'tighten';
                phaseTimeLeft = tightenTime;
                updateDisplay();
                updatePhaseDisplay();
                startBtn.innerHTML = '<i class="fas fa-play"></i> 开始训练';
            }, 3000);
        }
        
        // 设置训练时长
        function setSessionTime(seconds) {
            if (isRunning) {
                alert('请先停止当前训练后再更改时长');
                return;
            }
            
            initialTime = seconds;
            timeLeft = seconds;
            updateDisplay();
            
            // 更新活动按钮状态
            sessionButtons.forEach(btn => {
                if (parseInt(btn.dataset.time) === seconds) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }
        
        // 事件监听器
        startBtn.addEventListener('click', () => {
            if (!isRunning && !isPaused) {
                startTimer();
            } else if (isPaused) {
                startTimer();
            } else {
                // 如果正在运行，点击将重新开始
                resetTimer();
                startTimer();
            }
        });
        
        pauseBtn.addEventListener('click', pauseTimer);
        resetBtn.addEventListener('click', resetTimer);
        
        // 训练时长选择
        sessionButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const seconds = parseInt(btn.dataset.time);
                setSessionTime(seconds);
            });
        });
        
        // 缩紧时间滑块
        tightenSlider.addEventListener('input', function() {
            tightenTime = parseInt(this.value);
            tightenValue.textContent = tightenTime;
            
            if (!isRunning) {
                phaseTimeLeft = tightenTime;
                updatePhaseDisplay();
            }
            
            saveSettings();
        });
        
        // 放松时间滑块
        relaxSlider.addEventListener('input', function() {
            relaxTime = parseInt(this.value);
            relaxValue.textContent = relaxTime;
            saveSettings();
        });
        
        // 声音和震动开关
        soundToggle.addEventListener('change', saveSettings);
        vibrationToggle.addEventListener('change', saveSettings);
        
        // 初始化显示
        updateDisplay();
        updatePhaseDisplay();
        
        // 添加页面离开前的确认
        window.addEventListener('beforeunload', (e) => {
            if (isRunning) {
                e.preventDefault();
                e.returnValue = '训练正在进行中，确定要离开吗？';
            }
        });
    </script>
</body>
</html>